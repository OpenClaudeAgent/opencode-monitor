dangerous_patterns:
  - regex: '\brm\s+(-[a-zA-Z]*f[a-zA-Z]*\s+)?-[a-zA-Z]*r[a-zA-Z]*\s+/'
    score: 95
    reason: "Recursive delete from root"
    mitre_techniques:
      - T1485
      - T1070
    context_adjustments: []

  - regex: '\brm\s+-rf\s+/\s*$'
    score: 100
    reason: "Delete entire filesystem"
    mitre_techniques:
      - T1485
    context_adjustments: []

  - regex: '\brm\s+-rf\s+~\s*$'
    score: 85
    reason: "Delete home directory"
    mitre_techniques:
      - T1485
    context_adjustments: []

  - regex: 'curl\s+[^|]*\|\s*(ba)?sh'
    score: 95
    reason: "Remote code execution via curl"
    mitre_techniques:
      - T1059
      - T1105
    context_adjustments: []

  - regex: 'wget\s+[^|]*\|\s*(ba)?sh'
    score: 95
    reason: "Remote code execution via wget"
    mitre_techniques:
      - T1059
      - T1105
    context_adjustments: []

  - regex: '\bsudo\s+'
    score: 55
    reason: "Privilege escalation"
    mitre_techniques:
      - T1548
    context_adjustments:
      - pattern: 'sudo\s+(brew|apt|yum|dnf|pacman)\s+install'
        adjustment: -20
      - pattern: 'sudo\s+rm\s+-rf'
        adjustment: 30

  - regex: '\bchmod\s+777'
    score: 70
    reason: "World-writable permissions"
    mitre_techniques:
      - T1222
    context_adjustments: []

  - regex: '\bchmod\s+-R\s+777'
    score: 80
    reason: "Recursive world-writable"
    mitre_techniques:
      - T1222
    context_adjustments: []

  - regex: 'git\s+push\s+.*--force.*\s+(main|master)\b'
    score: 85
    reason: "Force push to main"
    mitre_techniques: []
    context_adjustments: []

  - regex: '\bDROP\s+(DATABASE|TABLE|SCHEMA)\b'
    score: 80
    reason: "SQL DROP operation"
    mitre_techniques:
      - T1485
    context_adjustments: []

safe_patterns:
  - regex: '\bmake\s+(test|check|build|install)\b'
    score: 0
    reason: "Standard build commands"
    mitre_techniques: []
    context_adjustments: []

  - regex: '\bgit\s+(status|log|diff|branch|show)\b'
    score: 0
    reason: "Read-only git commands"
    mitre_techniques: []
    context_adjustments: []

  - regex: '\bls\s+'
    score: 0
    reason: "List directory"
    mitre_techniques: []
    context_adjustments: []

  - regex: '\bcat\s+'
    score: 0
    reason: "Read file"
    mitre_techniques: []
    context_adjustments: []
